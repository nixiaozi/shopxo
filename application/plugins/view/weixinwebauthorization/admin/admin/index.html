{{include file="public/header" /}}

<!-- right content start  -->
<div class="content-right">
    <div class="content">
        <legend>
            <span class="fs-16">微信网页授权</span>
            <a href="{{:MyUrl('admin/pluginsadmin/index')}}" class="fr fs-14 m-t-5 am-icon-mail-reply"> 返回</a>
        </legend>
        <div class="am-alert" data-am-alert>
            <p>1. 当前插件仅配合在微信环境中、微信公众号支付使用。</p>
            <p>2. 当用户发起支付的时候会调用当前插件获取用户openid并绑定当前用户。</p>
            <p>3. 当采用弹出授权形式会同时获取用户unionid并更新到当前用户表。</p>
            <p>4. 也可以开启登录入口，让用户使用微信直接登录（<span class="am-text-danger">需要注意的是如果用户首次使用该功能进行登录且在当前没有帐号登录的情况下会创建新的帐号</span>）。</p>
            <p>5. 优先1、调用支付之前可种session[ plugins_weixinwebauth_pay_callback_view_url ]回调url地址，网页授权成功后（<span class="am-text-danger">如存在session回调地址直接跳转至地址，则默认提示页面</span>）</p>
            <p>6. 优先2、来源页面的地址[ plugins_weixinwebauth_pay_callback_view_url ]回调url地址，网页授权成功后（<span class="am-text-danger">如存在session回调地址直接跳转至地址，则默认提示页面</span>）</p>
        </div>
        <div class="weixinwebauthorization-content">

            <div class="items">
                <label>AppID</label>
                <div>
                    {{if !empty($data['appid'])}}
                        {{$data.appid}}
                    {{else /}}
                        未填写
                    {{/if}}
                </div>
            </div>
            <div class="items">
                <label>AppSecret</label>
                <div>
                    {{if !empty($data['secret'])}}
                        {{$data.secret}}
                    {{else /}}
                        未填写
                    {{/if}}
                </div>
            </div>

            <div class="items">
                <label>登录入口名称</label>
                <div>
                    {{if !empty($data['login_name'])}}
                        {{$data.login_name}}
                    {{else /}}
                        未填写（不显示）
                    {{/if}}
                </div>
            </div>
            <div class="items">
                <label>微信用户名前缀</label>
                <div>
                    {{if !empty($data['nickname'])}}
                        {{$data.nickname}}
                    {{else /}}
                        微信
                    {{/if}}
                </div>
            </div>

            <div class="items">
                <label>授权方式</label>
                <div>
                    {{if isset($data['auth_type']) and $data['auth_type'] eq 1}}
                        弹出授权
                    {{else /}}
                        静默授权
                    {{/if}}
                </div>
            </div>

            <div class="items">
                <label>自动登录</label>
                <div>
                    {{if isset($data['is_weoxin_env_auto_login']) and $data['is_weoxin_env_auto_login'] eq 1}}
                        是
                    {{else /}}
                        否
                    {{/if}}
                </div>
            </div>

            <div class="items">
                <label>登录授权地址</label>
                <div>
                    <a href="{{:PluginsHomeUrl('weixinwebauthorization', 'auth', 'index')}}" target="_blank">{{:PluginsHomeUrl('weixinwebauthorization', 'auth', 'index')}}</a>
                </div>
            </div>

            <div class="items">
                <label>公众号/服务号支付目录</label>
                <div>
                    <a href="{{$Think.__MY_URL__}}" target="_blank">
                        {{$Think.__MY_URL__}}
                    </a><br />
                    <a href="{{$Think.__MY_URL__}}index/order/" target="_blank">
                        {{$Think.__MY_URL__}}index/order/
                    </a>
                </div>
            </div>

            <a href="{{:PluginsAdminUrl('weixinwebauthorization', 'admin', 'saveinfo')}}" class="am-btn am-btn-secondary am-radius btn-loading-example am-btn-sm am-btn-block edit-submit">编辑</a>
        </div>
    </div>
</div>
<!-- right content end  -->
        
<!-- footer start -->
{{include file="public/footer" /}}
<!-- footer end -->